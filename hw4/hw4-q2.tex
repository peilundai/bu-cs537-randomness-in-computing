\documentclass[10pt]{537homework}

% For including image files
\usepackage{graphicx}
\usepackage[ruled,vlined,noline]{algorithm2e}
% set the vertical spacing between paragraphs
\setlength{\parskip}{1.5mm}

% For fancy math
\RequirePackage{amsmath,amsthm,amssymb}
\newtheorem{theorem}{Theorem}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
%\usepackage{amsmath}
\usepackage{titlesec}
\titleformat{\subsection}[runin]{}{}{}{}[]

\newcommand{\ord}[2][th]{\ensuremath{{#2}^{\mathrm{#1}}}}
% shorthand for \mathcal{O}
\newcommand{\Ocal}{\ensuremath{\mathcal{O}}}


% homework number
\hwnumber{4}
% problem number
\problemnumber{2}
% your name
\author{Peilun Dai}
% Collaborators. If you didn't collaborate, write "\collaborators{none}".
% If you did, for each collaborator, write "worked together", "I helped him/her" or "He/she helped me".
 \collaborators{None}


\begin{document}
\section*{2. (Fish) }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{(a)} 

Solution: This is a problem similar to the Coupon Collector's Problem covered in lecture. Let $X_i$ denote the number of fish caught while we already have $i-1$ different fish caught. Then the total number of fish caught in order to get all kinds is $X = \sum_{i=1}^n X_i$ where $X_i$ follows a geometric distribution, i.e, $X_i \sim Geom(p_i)$, and $p_i = 1 - {i-1 \over n}$. 

\begin{align*}
  \mathbb{E}(X_i) & = {1 \over p_i} = {n \over n-i+1} \\
  \mathbb{E}(X)   & = \mathbb{E}\Big[ \sum_{i=1}^n  X_i \Big] \\
                  & = \sum_{i=1}^n \mathbb{E}[ X_i ] \\
                  & = \sum_{i=1}^n { n \over n - i + 1} \\
                  & = n \sum_{i=1}^n {1 \over i} \\
                  & = n H(n) \approx n(\ln{n} + \Theta(1)) = n\ln{n} + \Theta(n)
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{(b)}

Solution: Let $X_i$ be an indicator random variable denoting whether the fish kind $i$ is not caught when $2n$ fish have been caught. Let $X$ denote the number of kinds of fish not caught when $2n$ fish have been caught. 

\begin{align*}
  \mathbb{E}(X_i)   & = Pr[X_i=1] \\
                    & = \big(1 - {1 \over n}\big)^{2n} \\
  \mathbb{E}(X)     & = \mathbb{E}(\sum_{i=1}^n X_i) \\
                    & = \sum_{i=1}^n \mathbb{E}(X_i) \\
                    & = n\big(1 - {1 \over n}\big)^{2n}
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{(c)}

Solution: Let $Y_i$ be an indicator random variable denoting whether the fish kind $i$ has only been caught exactly once after $3n$ fish being caught. 

\begin{align*}
  \mathbb{E}(Y_i)   & = Pr[Y_i = 1] \\
                    & = {3n \choose 1} \big( 1 - {1\over n}\big)^{3n-1}\big( {1\over n}\big) \\
  \mathbb{E}(Y)     & = \mathbb{E}(\sum_i^n Y_i) \\
                    & = \sum_i^n \mathbb{E}(Y_i) \\
                    & = n{3n \choose 1} \big( 1 - {1\over n}\big)^{3n-1}\big( {1\over n}\big) = 3n({n-1 \over n})^{3n-1}
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{(d)}

Solution: We can use similar method in (a). Let $X_i$ denote the number of fish caught while we already have $i-1$ different fish caught. Then the total number of fish we need to get $n/2$ kinds of fish is $X = \sum_{i=1}^{n/2} X_i$ where $X_i \sim Geom(1-{i-1 \over n})$. 

\begin{align*}
  \mathbb{E}(X)     & = \mathbb{E}(\sum_{i}^{n/2} X_i) \\
                    & = \sum_{i=1}^{n/2} {n \over n-i+1} \\
                    & = n\sum_{i=n/2+1}^n {1\over i} \\
                    & = n (H(n) - H(n/2)) \approx n(\ln{n} - \ln{n/2}) + \Theta (n) = n \ln{2} + \Theta(n)
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{(e)}

Solution: Let $F_i$ be the total number of fish for generation $i$ and $F$ be the number of fish in all generations. 

\begin{align*}
  \mathbb{E}(F_1)     & = 1p_1 + 2p_2 \\
  \mathbb{E}(F_2)     & = \mathbb{E}(F_1)p_1 + 2\mathbb{E}(F_1)p_2 = \mathbb{E}(F_1)(p_1 + 2p_2) = (p_1 + 2p_2)^2\\
  \mathbb{E}(F_3)     & = \mathbb{E}(F_2)p_1 + 2\mathbb{E}(F_2)p_2 = \mathbb{E}(F_2)(p_1 + 2p_2) = (p_1 + 2p_2)^3 \\
  & \vdots \\
  \mathbb{E}(F_i) & = (p_1 + 2p_2)^i
\end{align*}

Thus, the expected number of fish in the talk will be 

\begin{align*}
  \mathbb{E}(F)   & = \mathbb{E}(\sum_{i=1}^{\infty} F_i) \\
                  & = \sum_{i=1}^{\infty} (p_1 + 2p_2)^i = {1 \over 1 - (p_1 + 2p_2)} \text{, given $p_1 + 2p_2 < 1$}
\end{align*}

The above sum is bounded only when $p_1 + 2p_2 < 1$.

\end{document} 

















































